# sim/ - Testbenches and Verilator Integration

This folder contains **testbenches and integration files** for simulating and verifying the Verilog RTL blocks of the MFCC hardware pipeline, including full Verilator C++ co-simulation support.

---

## Contents

| File Name           | Description |
|--------------------|-------------|
| `tb_fft.v`          | Verilog testbench to test the standalone FFT block. |
| `mel_filter_tb.v`   | Testbench for verifying the Mel filterbank RTL module. |
| `log_compression_tb.v` | Testbench for the log compression unit. |
| `dct_tb.v`          | Unit test for the DCT module using pre-generated cosine coefficients. |
| `mfcc_top_tb.v`     | Verilog testbench for end-to-end MFCC pipeline, feeding 512 inputs and waiting for `done`. |
| `mfcc_top_tb.cpp`   | Verilator-compatible C++ testbench that feeds real audio input (from `input_array.h`) and measures simulation time. |
| `input_array.h`     | Auto-generated header file containing a single 512-sample frame used for hardware simulation. Populated by `integration/extract_frame.py`.

---

## Notes

- All Verilog testbenches use Icarus Verilog (`iverilog`) or Verilator (`verilator`) depending on context.
- The `mfcc_top_tb.cpp` file allows real-time testing of the RTL design against extracted audio data with timing instrumentation.
- `input_array.h` is dynamically generated by preprocessing Python scripts (`integration/`) and serves as hardware input.

---

## How to Run with Verilator

```bash
# Build
verilator -Wall --cc rtl/mfcc_top.v sim/mfcc_top_tb.v --exe sim/mfcc_top_tb.cpp -Irtl --top-module mfcc_top_tb
make -C obj_dir -f Vmfcc_top_tb.mk Vmfcc_top_tb

# Run
./obj_dir/Vmfcc_top_tb
